{
  "permissions": {
    "allow": [
      "Bash(claude mcp add:*)",
      "Bash(npm install:*)",
      "Bash(npx prisma init:*)",
      "Bash(npx shadcn@latest init:*)",
      "Bash(npx shadcn@latest add:*)",
      "Bash(npx husky:*)",
      "Bash(npm run test:run:*)",
      "Bash(npm uninstall:*)",
      "Bash(git add:*)",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nfeat: 初期プロジェクトセットアップ\n\n- Next.js 16 \\(App Router, TypeScript, Tailwind CSS v4\\)\n- Prisma v5 + PostgreSQL スキーマ定義\n- shadcn/ui コンポーネント\n- ESLint v9 + Prettier 設定\n- Vitest + Testing Library 設定\n- Husky + lint-staged 設定\n- 設計ドキュメント \\(DB設計、API設計、画面設計、テスト仕様\\)\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(npm run lint:*)",
      "Bash(git remote add:*)",
      "Bash(git branch:*)",
      "Bash(git push:*)",
      "Bash(powershell -Command:*)",
      "Bash(\"C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe\" --version)",
      "Bash(\"C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe\" auth status)",
      "Bash(\"C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe\" auth login --web --hostname github.com)",
      "Bash(\"C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe\" repo view --json nameWithOwner -q .nameWithOwner)",
      "Bash(\"C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe\" issue create:*)",
      "Bash(\"C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe\" issue create --title \"食品マスタ機能の実装（API・画面）\" --body \"$\\(cat <<''EOF''\n## 概要\n食品マスタのCRUD機能をAPI・画面両方で実装する。\n\n## 前提条件\n- Issue #1 認証機能の実装が完了していること\n\n## 対象ファイル\n- `src/app/api/v1/foods/route.ts` - 食品一覧・登録API\n- `src/app/api/v1/foods/[id]/route.ts` - 食品詳細・更新・削除API\n- `src/app/\\(main\\)/foods/page.tsx` - 食品マスタ一覧画面\n- `src/app/\\(main\\)/foods/new/page.tsx` - 食品登録画面\n- `src/app/\\(main\\)/foods/[id]/edit/page.tsx` - 食品編集画面\n- `src/components/food/` - 食品関連コンポーネント\n- `src/lib/validations/food.ts` - 食品バリデーションスキーマ\n\n## 実装内容\n\n### 1. 食品マスタAPI実装\n- [ ] `GET /api/v1/foods` - 食品一覧取得\n  - 検索（q パラメータ）\n  - ページネーション（page, limit）\n  - ユーザーの食品 + デフォルト食品を返却\n- [ ] `GET /api/v1/foods/:id` - 食品詳細取得\n  - 所有者チェック\n- [ ] `POST /api/v1/foods` - 食品登録\n  - バリデーション（Zod）\n  - 認証ユーザーに紐付け\n- [ ] `PUT /api/v1/foods/:id` - 食品更新\n  - 所有者チェック\n  - 部分更新対応\n- [ ] `DELETE /api/v1/foods/:id` - 食品削除\n  - 所有者チェック\n  - 使用中チェック（FOOD_IN_USE エラー）\n\n### 2. 食品マスタ画面実装\n- [ ] FOOD-001: 食品マスタ一覧画面 \\(`/foods`\\)\n  - 検索フィールド\n  - 食品リスト表示（カロリー・PFC表示）\n  - マイ食品 / よく使う食品セクション\n  - 追加ボタン\n  - 編集・削除アクション\n- [ ] FOOD-002: 食品マスタ登録画面 \\(`/foods/new`\\)\n  - 食品名入力\n  - 基準量・単位選択\n  - カロリー・PFC入力\n  - PFCバランスグラフ表示\n  - 保存ボタン\n- [ ] 食品編集画面 \\(`/foods/[id]/edit`\\)\n  - 既存データの読み込み\n  - 更新処理\n\n### 3. 共通コンポーネント\n- [ ] `FoodCard` - 食品情報カード\n- [ ] `FoodForm` - 食品入力フォーム\n- [ ] `PFCBalanceChart` - PFCバランス表示\n- [ ] `FoodSearchInput` - 食品検索入力\n\n### 4. バリデーション\n- [ ] 食品名: 1-200文字\n- [ ] カロリー・PFC: 0以上の数値\n- [ ] 基準量: 1以上\n- [ ] 単位: g/ml/個/杯/枚\n\n## テスト\n- [ ] 食品バリデーションの単体テスト\n- [ ] 食品APIの結合テスト\n  - 一覧取得（検索・ページネーション）\n  - CRUD操作\n  - 権限チェック\n  - 使用中削除エラー\n\n## 参照\n- [API設計書 - 食品マスタAPI]\\(docs/api-design.md#食品マスタ-api\\)\n- [画面定義書 - FOOD-001, FOOD-002]\\(docs/screen-design.md#food-001-食品マスタ一覧画面\\)\n- [テスト仕様書 - UT-003, IT-002]\\(docs/test-specification.md\\)\n\n## 完了条件\n- [ ] 食品の登録・編集・削除ができる\n- [ ] 食品一覧の検索・ページネーションが動作する\n- [ ] 権限チェックが正しく動作する\n- [ ] 単体テスト・結合テストがパスする\nEOF\n\\)\")",
      "Bash(\"C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe\" issue create --title \"ホーム画面・集計機能・設定画面の実装\" --body \"$\\(cat <<''EOF''\n## 概要\nメインのホーム画面（カレンダー表示）、日次・月次集計API、設定画面（目標値設定）を実装する。\n\n## 前提条件\n- Issue #1 認証機能の実装が完了していること\n- Issue #2 食品マスタ機能の実装が完了していること\n- Issue #3 食事記録機能の実装が完了していること\n\n## 対象ファイル\n- `src/app/api/v1/summary/daily/route.ts` - 日次サマリーAPI\n- `src/app/api/v1/summary/monthly/route.ts` - 月次サマリーAPI\n- `src/app/api/v1/users/me/route.ts` - ユーザー情報更新API\n- `src/app/api/v1/users/me/targets/route.ts` - 目標値更新API\n- `src/app/\\(main\\)/page.tsx` - ホーム画面（カレンダー）\n- `src/app/\\(main\\)/settings/page.tsx` - 設定画面\n- `src/components/home/` - ホーム関連コンポーネント\n- `src/components/settings/` - 設定関連コンポーネント\n\n## 実装内容\n\n### 1. 集計ユーティリティ\n- [ ] `calculateAchievementRate\\(actual, target\\)` - 達成率計算\n- [ ] `aggregateDailySummary\\(meals\\)` - 日次集計\n- [ ] `aggregateMonthlySummary\\(dailySummaries\\)` - 月次集計\n\n### 2. 集計API実装\n- [ ] `GET /api/v1/summary/daily?date=YYYY-MM-DD` - 日次サマリー\n  - totals: カロリー・PFC合計\n  - targets: ユーザーの目標値\n  - achievement: 達成率（%）\n  - by_meal_type: 食事タイプ別内訳\n- [ ] `GET /api/v1/summary/monthly?year=YYYY&month=MM` - 月次サマリー\n  - targets: ユーザーの目標値\n  - daily_summaries: 各日のカロリー・has_records\n  - monthly_average: 月平均値\n\n### 3. ユーザー設定API実装\n- [ ] `PUT /api/v1/users/me` - ユーザー情報更新\n  - name, email の更新\n- [ ] `PUT /api/v1/users/me/password` - パスワード変更\n  - current_password, new_password\n- [ ] `PUT /api/v1/users/me/targets` - 目標値更新\n  - daily_calorie_target\n  - daily_protein_target\n  - daily_fat_target\n  - daily_carb_target\n\n### 4. ホーム画面実装\n- [ ] HOME-001: ホーム画面（カレンダー）\\(`/`\\)\n  - 月間カレンダー表示\n  - 各日のカロリー表示\n  - 月切り替え（◀ ▶）\n  - 選択日のサマリー表示\n  - プログレスバー（目標達成率）\n  - PFCバランス表示\n  - 「+ 食事を記録する」ボタン\n  - 日付タップ → サマリー更新\n  - 日付ダブルタップ → 食事記録一覧へ遷移\n\n### 5. 設定画面実装\n- [ ] USER-001: 設定画面 \\(`/settings`\\)\n  - アカウント情報セクション\n    - ユーザー名表示・編集\n    - メールアドレス表示・編集\n    - パスワード変更リンク\n  - 目標値設定セクション\n    - 目標カロリー入力（500-10000）\n    - 目標タンパク質入力（1-500）\n    - 目標脂質入力（1-500）\n    - 目標炭水化物入力（1-1000）\n    - 保存ボタン\n  - ログアウトボタン\n\n### 6. 共通コンポーネント\n- [ ] `CalendarGrid` - カレンダーグリッド\n- [ ] `DaySummaryCard` - 日次サマリーカード\n- [ ] `ProgressBar` - プログレスバー\n- [ ] `PFCSummary` - PFCサマリー表示\n- [ ] `TargetForm` - 目標値入力フォーム\n- [ ] `Header` - 共通ヘッダー\n- [ ] `BottomNav` - フッターナビゲーション\n\n### 7. レイアウト\n- [ ] 認証済みユーザー用レイアウト \\(`src/app/\\(main\\)/layout.tsx`\\)\n  - ヘッダー\n  - フッターナビゲーション\n  - Toasterコンポーネント\n\n## テスト\n- [ ] 達成率計算の単体テスト\n- [ ] 集計APIの結合テスト\n  - 日次サマリー\n  - 月次サマリー\n- [ ] ユーザー設定APIの結合テスト\n\n## 参照\n- [API設計書 - 集計API]\\(docs/api-design.md#集計-api\\)\n- [API設計書 - ユーザーAPI]\\(docs/api-design.md#ユーザー-api\\)\n- [画面定義書 - HOME-001, USER-001]\\(docs/screen-design.md#home-001-ホーム画面カレンダー\\)\n- [テスト仕様書 - UT-002, IT-004]\\(docs/test-specification.md\\)\n\n## 完了条件\n- [ ] カレンダーで月間の記録状況を確認できる\n- [ ] 日次サマリーで目標達成率を確認できる\n- [ ] 目標値を設定・変更できる\n- [ ] ログアウトができる\n- [ ] 単体テスト・結合テストがパスする\n\n## 備考\nこのIssueが完了すると、アプリの主要機能がすべて実装されます。\nEOF\n\\)\")",
      "Bash(\"C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe\" issue list --state open)",
      "Bash(npm run build:*)",
      "Bash(git commit:*)",
      "Bash(gcloud run services get-iam-policy:*)",
      "Bash(gcloud run services add-iam-policy-binding:*)",
      "Bash(gcloud secrets list:*)",
      "Bash(openssl rand:*)",
      "Bash(gcloud secrets create:*)",
      "Bash(gcloud secrets add-iam-policy-binding:*)",
      "Bash(docker build:*)",
      "Bash(docker run:*)",
      "Bash(gh issue view:*)",
      "Bash(gh.exe issue view:*)",
      "Bash(cmd.exe /c \"gh issue view 2\")",
      "Bash(xargs cat:*)",
      "Bash(npm run test:*)",
      "mcp__context7__resolve-library-id",
      "mcp__context7__query-docs",
      "Bash(npm test:*)"
    ]
  }
}
